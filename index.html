<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Softball Lineup Manager</title>
  <style>
    body { font-family: Arial, sans-serif; background: #4caf50; color: white; text-align: center; }
    #field {
      position: relative;
      width: 600px; height: 600px;
      margin: 20px auto;
      background: radial-gradient(circle at center, #d2b48c 200px, #4caf50 200px);
      border: 4px solid #fff; border-radius: 50%;
    }
    .slot {
      width: 32px; height: 32px;
      background: white; border-radius: 50%;
      text-align: center; line-height: 10px;
      font-size: 9px; font-weight: bold;
      position: absolute; border: 2px solid #000;
      color: #000; padding: 2px;
    }
    .slot .player { font-size: 8px; display: block; margin-top: 2px; }

    #buckets { display: flex; justify-content: space-around; margin: 20px; }
    .bucket {
      width: 200px; min-height: 150px;
      background: rgba(255,255,255,0.2); border: 2px dashed white;
      border-radius: 10px; padding: 10px;
    }
    .player {
      background: #fff; color: #000;
      margin: 4px; padding: 4px; border-radius: 6px;
      cursor: grab; font-size: 14px;
    }
    button {
      margin: 10px; padding: 8px 16px;
      font-size: 14px; border-radius: 6px;
      border: none; cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Softball Lineup Manager</h1>
  <div id="field"></div>

  <div id="buckets">
    <div class="bucket" id="roster"><h3>Roster</h3></div>
    <div class="bucket" id="outfield"><h3>Outfield</h3></div>
    <div class="bucket" id="sub"><h3>Sub</h3></div>
    <div class="bucket" id="reset"><h3>Reset</h3></div>
  </div>

  <button onclick="saveToGitHub()">Save to GitHub</button>

  <script>
    const players = ["Corbin","Danielle","Marcus","Natalie","Russell","Vamsi","Brianna","Charles","Matt Johnson"];
    const positions = {
      "P": [280, 280], "C": [280, 340], "1B": [400, 300], "2B": [320, 240],
      "3B": [160, 300], "SS": [240, 240], "LF": [100, 100], "CF": [280, 60], "RF": [460, 100]
    };

    let lineup = {}; // position -> player
    const field = document.getElementById("field");

    // Draw positions
    for (const pos in positions) {
      const [x,y] = positions[pos];
      const slot = document.createElement("div");
      slot.className = "slot";
      slot.style.left = `${x}px`; slot.style.top = `${y}px`;
      slot.dataset.position = pos;
      slot.innerHTML = `<div>${pos}</div><div class="player"></div>`;
      slot.ondragover = e => e.preventDefault();
      slot.ondrop = dropPlayer;
      field.appendChild(slot);
    }

    // Fill roster
    const rosterDiv = document.getElementById("roster");
    players.forEach(p => {
      const div = document.createElement("div");
      div.className = "player";
      div.textContent = p;
      div.draggable = true;
      div.ondragstart = dragPlayer;
      rosterDiv.appendChild(div);
    });

    // Drag & drop
    let draggedPlayer = null;
    function dragPlayer(e){ draggedPlayer = e.target; }
    function dropPlayer(e){
      const pos = e.currentTarget.dataset.position;
      e.currentTarget.querySelector(".player").textContent = draggedPlayer.textContent;
      lineup[pos] = draggedPlayer.textContent;
    }

    // Reset bucket clears slot
    document.getElementById("reset").ondrop = e => {
      e.preventDefault();
      if (!draggedPlayer) return;
      // find slot that contains this player
      for (const pos in lineup){
        if(lineup[pos] === draggedPlayer.textContent){
          delete lineup[pos];
          [...document.querySelectorAll(".slot .player")].forEach(el=>{
            if(el.textContent===draggedPlayer.textContent) el.textContent="";
          });
        }
      }
    };
    document.getElementById("reset").ondragover = e => e.preventDefault();

    // Save to GitHub
    async function saveToGitHub() {
      const token = "YOUR_TOKEN";  // replace with your GitHub token
      const repo = "YOUR_USERNAME/YOUR_REPO"; // e.g. vamsibhaskar/softball-lineup
      const filePath = "lineup.json";
      const content = btoa(unescape(encodeURIComponent(JSON.stringify(lineup, null, 2))));
      let sha = null;
      try {
        const res = await fetch(`https://api.github.com/repos/${repo}/contents/${filePath}`, {
          headers: { Authorization: `token ${token}` }
        });
        if (res.ok) { const data = await res.json(); sha = data.sha; }
      } catch(e){}
      await fetch(`https://api.github.com/repos/${repo}/contents/${filePath}`, {
        method: "PUT",
        headers: {
          "Authorization": `token ${token}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          message: "Update lineup",
          content: content,
          sha: sha || undefined
        })
      });
      alert("âœ… Lineup saved to GitHub!");
    }
  </script>
</body>
</html>
