<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Softball Positions Editor</title>
<style>
body { font-family: Arial; display:flex; flex-direction:column; align-items:center; padding:10px;}
#field { width:360px; height:360px; position:relative; background:#228B22; border-radius:10px; margin-bottom:20px;}
#infield { position:absolute; width:140px; height:140px; background:#a0522d; top:110px; left:110px; transform:rotate(45deg); border-radius:5px;}
.base { position:absolute; width:12px; height:12px; background:white; transform:translate(-50%,-50%); border-radius:2px; }
.slot { width:25px; height:25px; background:white; border-radius:50%; text-align:center; line-height:25px; font-size:10px; position:absolute; border:2px solid #000; font-weight:bold; color:#000; }
.bucket { width:360px; min-height:40px; margin-bottom:20px; padding:5px; border:2px dashed #000; border-radius:5px; display:flex; flex-wrap:wrap; align-items:center; }
.bucket-title { width:100%; font-weight:bold; margin-bottom:5px; }
.player { width:80px; height:30px; background:#87cefa; margin:2px; text-align:center; line-height:30px; border-radius:4px; font-size:12px; cursor:grab; position:relative; }
.slot .player { font-size:10px; width:60px; height:20px; line-height:20px; position:absolute; top:100%; left:50%; transform:translateX(-50%) translateY(2px); background:#87cefa; border-radius:4px; text-align:center; }
button { margin:10px; padding:8px 12px; font-size:16px; border-radius:5px; cursor:pointer; }
</style>
</head>
<body>
<h2>Softball Positions Editor</h2>

<div id="field">
  <div id="infield"></div>
  <div class="base" style="bottom:50px; left:50px;"></div>
  <div class="base" style="bottom:50px; right:50px;"></div>
  <div class="base" style="top:50px; left:50%; transform:translateX(-50%);"></div>
  <div class="base" style="bottom:10px; left:50%; transform:translateX(-50%);"></div>

  <div class="slot" data-pos="1B" style="bottom:50px; right:50px;">1B</div>
  <div class="slot" data-pos="2B" style="top:50px; left:50%; transform:translateX(-50%);">2B</div>
  <div class="slot" data-pos="3B" style="bottom:50px; left:50px;">3B</div>
  <div class="slot" data-pos="SS" style="bottom:80px; left:35%;">SS</div>
  <div class="slot" data-pos="P" style="top:50%; left:50%; transform:translate(-50%,50%);">P</div>
  <div class="slot" data-pos="C" style="bottom:10px; left:50%; transform:translateX(-50%);">C</div>
  <div class="slot" data-pos="LF" style="top:20px; left:40px;">LF</div>
  <div class="slot" data-pos="CF" style="top:0px; left:50%; transform:translateX(-50%);">CF</div>
  <div class="slot" data-pos="RF" style="top:20px; right:40px;">RF</div>
</div>

<div class="bucket" id="roster"><div class="bucket-title">Roster</div></div>
<div class="bucket" id="outfield"><div class="bucket-title">Outfield</div></div>
<div class="bucket" id="sub"><div class="bucket-title">Sub for the Inning</div></div>

<button id="copyBtn">Copy positions.json to Clipboard</button>
<button id="resetBtn">Reset Field</button>

<script>
// Player list
const allPlayers = ["Vamsi", "Brianna", "Marcus", "Natalie", "Corbin", "Ellison", "Charles", "Matt Johnson", "Danielle", "Lauren", "Taylor"];

// Initial empty positions
let positions = {
  "P": null, "C": null, "1B": null, "2B": null,
  "3B": null, "SS": null, "LF": null, "CF": null,
  "RF": null, "Outfield": [], "Sub": []
};

// Render field and buckets
function renderField() {
  // Clear buckets
  ['roster','outfield','sub'].forEach(id=>{
    const bucket=document.getElementById(id);
    bucket.querySelectorAll('.player').forEach(p=>p.remove());
  });

  // Clear slots
  document.querySelectorAll('.slot').forEach(slot=>{
    const pos = slot.dataset.pos;
    slot.innerHTML = pos;
    if(positions[pos]){
      const pDiv=document.createElement('div');
      pDiv.classList.add('player');
      pDiv.textContent=positions[pos];
      makeDraggable(pDiv);
      slot.appendChild(pDiv);
    }
  });

  // Fill roster with unassigned players
  const assigned = Object.values(positions).filter(v=>typeof v==="string" && v).concat(positions["Outfield"], positions["Sub"]);
  const rosterDiv = document.getElementById('roster');
  allPlayers.forEach(name=>{
    if(!assigned.includes(name)){
      const pDiv=document.createElement('div'); pDiv.classList.add('player'); pDiv.textContent=name;
      makeDraggable(pDiv);
      rosterDiv.appendChild(pDiv);
    }
  });

  // Fill outfield and sub buckets
  positions["Outfield"].forEach(name=>{
    const pDiv=document.createElement('div'); pDiv.classList.add('player'); pDiv.textContent=name;
    makeDraggable(pDiv);
    document.getElementById('outfield').appendChild(pDiv);
  });
  positions["Sub"].forEach(name=>{
    const pDiv=document.createElement('div'); pDiv.classList.add('player'); pDiv.textContent=name;
    makeDraggable(pDiv);
    document.getElementById('sub').appendChild(pDiv);
  });
}

// Drag-and-drop for mobile and desktop
function makeDraggable(player){
  let dragged=null, offsetX=0, offsetY=0;
  player.addEventListener('mousedown',startDrag);
  player.addEventListener('touchstart',startDrag,{passive:false});
  function startDrag(e){
    e.preventDefault();
    dragged=player;
    const rect=dragged.getBoundingClientRect();
    offsetX=e.touches?e.touches[0].clientX-rect.left:e.offsetX;
    offsetY=e.touches?e.touches[0].clientY-rect.top:e.offsetY;
    dragged.style.position='absolute'; dragged.style.zIndex=1000;
    document.addEventListener('mousemove',move);
    document.addEventListener('mouseup',drop);
    document.addEventListener('touchmove',move,{passive:false});
    document.addEventListener('touchend',drop);
  }
  function move(e){
    if(!dragged) return;
    e.preventDefault();
    const x = e.touches?e.touches[0].clientX:e.clientX;
    const y = e.touches?e.touches[0].clientY:e.clientY;
    dragged.style.left=(x-offsetX)+'px';
    dragged.style.top=(y-offsetY)+'px';
  }
  function drop(){
    if(!dragged) return;
    dragged.style.position='static'; dragged.style.zIndex='';
    dragged=null;
    updatePositionsFromDOM();
    renderField(); // re-render to reset position divs
  }
}

// Update positions object from DOM
function updatePositionsFromDOM(){
  document.querySelectorAll('.slot').forEach(slot=>{
    const p = slot.querySelector('.player');
    positions[slot.dataset.pos] = p?p.textContent:null;
  });
  positions["Outfield"] = Array.from(document.getElementById('outfield').children)
    .filter(c=>c.classList.contains('player')).map(c=>c.textContent);
  positions["Sub"] = Array.from(document.getElementById('sub').children)
    .filter(c=>c.classList.contains('player')).map(c=>c.textContent);
}

// Copy to clipboard
document.getElementById('copyBtn').addEventListener('click',()=>{
  updatePositionsFromDOM();
  navigator.clipboard.writeText(JSON.stringify(positions,null,2))
    .then(()=>alert('Lineup copied! Paste into GitHub positions.json'))
    .catch(()=>alert('Failed to copy'));
});

// Reset field
document.getElementById('resetBtn').addEventListener('click',()=>{
  positions = {
    "P": null, "C": null, "1B": null, "2B": null,
    "3B": null, "SS": null, "LF": null, "CF": null,
    "RF": null, "Outfield": [], "Sub": []
  };
  renderField();
});

// Initial render
renderField();
</script>
</body>
</html>
